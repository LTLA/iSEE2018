element;intro
#Welcome;This tour explores a single-cell RNA sequencing dataset containing 4,000 PBMCs from 10X Genomics. It will focus on differences between two methods of calling cells - using the default method in the <i>CellRanger</i> software from 10X Genomics, or using the <a href="https://doi.org/10.1101/234872"><i>emptyDrops</i> method</a>.<br/><br/><b>NOTE:</b> if the tour doesn't run properly at first, exit and click on the top-right question mark to start a new tour.
#redDimPlot1;Here we have a t-SNE plot of the union of all called cells, coloured by the algorithm used to detect it. <b>Action:</b> please select the <i>emptyDrops</i>-only cluster on the far left.
#colDataPlot1;Here we have a series of violin plots, showing the log-total UMI count for all cells in each cluster. You can see that cells in the selected cluster (visible points) have lower coverage than the others. This reflects the greater power of <i>emptyDrops</i> to detect cells with low RNA content.
#featExprPlot1;Analysis of these <i>emptyDrops</i>-only cells reveals that they are clearly upregulating the PF4 gene (visible points), relative to the other clusters.
#rowStatTable1_annotation;What is PF4, you might ask? Looking up the Ensembl annotation reveals that it stands for platelet factor 4. <b>Action:</b> click on the link.
#heatMapPlot1;And in fact, there are some other platelet-relevant genes that are present in the set of upregulated genes for the chosen cluster (non-transparent bars). This includes pr-platelet basic protein (PPBP), serum deprivation response protein (SDPR) and thymosin beta 4 X-linked (TMSB4X).
#redDimPlot1;Returning to the t-SNE plot - let's examine the middle <i>emptyDrops</i>-majority cluster, at about (-25, 10). <b>Action:</b> please select the middle <i>emptyDrops</i>-majority cluster, using either a Shiny brush or lasso.
#colDataPlot1;Again, we see that cells in the selection (visible points) have lower total UMI counts than that of most other clusters. However, the question becomes, what do these cells represent?
#colDataPlot1_DataBoxOpen;<b>Action:</b> first, let's open this box.
#colDataPlot1_YAxis + .selectize-control;<b>Action:</b> change the y-axis to "pct_counts_Mito". This can be typed in manually if you can't see the options due to this box.<br/><br/> You can see that most of the selected cells have elevated mitochondrial content, consistent with cell damage whereby mRNA leaks out of the cytoplasm (thus enriching for mitochondrial RNA).
#rowStatTable1;This is confirmed by having a look at the expression of mitochondrial genes. <b>Action:</b> Type "^MT-" in the search box to identify all genes from the mitochondrial genome.
#heatMapPlot1_FeatNameBoxOpen;<b>Action:</b> again, let's open this box.
#heatMapPlot1_FeatNameSource + .selectize-control;<b>Action:</br> Select "Row statistics table 1" here. 
#heatMapPlot1_Clear;<b>Action:</b> Clear out the existing features...
#heatMapPlot1_Import;<b>Action:</b> ... and import the mitochondrial features from the table. <br><br/> Examination of the new heatmap confirms the relative enrichment of mitochondrial transcripts in the selected cluster of cells (non-transparent bars).
#Conclusions;<i>emptyDrops</i> is designed to detect barcodes with expression profiles that differ significantly from the ambient pool, presumably due to the presence of a cell in the droplet. This avoids the use of a threshold on the total UMI count, allowing recovery of more cells from a single experiment. However, this is a double-edged sword, retaining cell types that would otherwise have been lost (platelets) but also low-quality damaged cells. Careful quality control downstream is recommended, especially on the mitochondrial content.
