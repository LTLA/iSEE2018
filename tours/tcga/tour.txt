element;intro
#Welcome;<p align="left">This tour illustrates salient features of The Cancer Genome Atlas (TCGA) RNA-Sequencing and clinical data for 7,706 tumor samples, based on count data reported by <a href="https://academic.oup.com/bioinformatics/article/31/22/3666/240143" target="_blank">Rahman et al. (Bioinformatics, 2015)</a>.</p><p align="left"><font color="##FF0000"><strong>NOTE:</strong></font> if the tour is not jumping to the correct UI elements, exit by clicking anywhere else on the app, and click on the top-right question mark to start a new tour.</p>
#Welcome;<p align="left">The data set contains measurements for 23,368 genes in 7,706 tumor samples and 705 matched control samples, across 20 cancer types. In addition, the data set of tumor samples includes 421 clinical variables collected as sample metadata.</p><p>The tumor and control data sets were obtained from the Bioconductor <a href="http://bioconductor.org/packages/ExperimentHub/" target="_blank">ExperimentHub</a> (records 'EH1' and 'EH1044').</p>
#colDataPlot1;<p align="left">The distribution of tumor and control samples across all cancer types can be easily visualized using a <font color="#402ee8">Column data plot</font> panel.</p><p align="left">In particular, note how tumor and control breast cancer samples (i.e., 'BRCA') are already selected. This allows downstream linked panels to selectively highlight or restrict those samples when they display data.</p>
#colDataPlot1_DataBoxOpen;<p align="left">Sample metadata shown on the X and Y axes were set using the <font color="#402ee8">Data parameters</font> box.</p>
#colDataPlot1_VisualBoxOpen;<p align="left">Similarly, the <font color="#402ee8">Visual parameters</font> box provides control over the color, point and other aspects of the data points.</p>
#colDataPlot1_ColorBy;<p align="left">Here, we reinforce the cancer type information by color.</p>
#colDataPlot1_Downsample;<p align="left">Given the considerable number of samples, we visually downsample data points to no more than 200 data points per category, to display and update panels more rapidly.</p><p align="left">Note that downsampling only has a <em>visual</em> effect. Hidden data points are still included in selections.</p>
#colDataPlot1_LegendPosition;<p align="left">Lastly, we also moved the legend to the right of the plotting panel (the default is 'Bottom').</p>
#colDataPlot1_PanelGeneralInfo;<p align="left">Conveniently, the count and proportion of samples selected is shown whenever an active selection is detected.</p>
#colDataPlot1_PanelLinkInfo;<p align="left">Furthermore, any incoming or outgoing selection link with another panel is reported here.</p><p align="left">In this example, the panel is sending its point selection to three other panels that we will examine in a moment.</p>
#redDimPlot1;<p align="left"><font color="#402ee8">Reduced dimension plot</font> panels provide an overview of the data in any precomputed reduced dimensions, such as <i>t</i>-SNE.</p><p align="left">Conveniently, any sample metadata or feature assay value may be overlaid as color onto the data points (e.g., control status), and linked selections received from other panels can be highlighted (e.g. breast cancer samples).</p>
#redDimPlot1_ColorBy;<p align="left">Here, we use color to distinguish control from tumor samples.</p>
#redDimPlot1_PanelLinkInfo;<p align="left">Furthermore, this panel receives the set of breast cancer samples selected in the <font color="#402ee8">Column data plot</font> panel, described earlier.</p>
#redDimPlot1_SelectEffect;<p align="left">The point selection received is applied with a transparency effect, that reduces the visibility of unselected data points to 10%, by default.</p>
#redDimPlot1_Downsample;<p align="left">Again, note how downsampling is applied to render the panel faster.</p>
#redDimPlot1_SampleRes;<p align="left">In this example, the plot is divided horizontally and vertically in 200 bins, showing no more than one data point per bin, and hiding additional data points from sight.</p>
#featAssayPlot1;<p align="left">Rahman <i>et al.</i> examined the effects of <i>HER2</i> (ERBB2) overexpression in breast cancer cells.</p><p>Here, we note that a subset of breast cancer tumor sample display markedly higher expression of <i>HER2</i>.</p>
#featAssayPlot1_DataBoxOpen;<p align="left">To visualize the differential expression, we used the <font color="#402ee8">Data parameters</font> box to assign <i>HER2</i> (ERBB2) to the Y-axis, show gene expression values from the assay that holds log<sub>2</sub> count per million (CPM) values, and separate tumor and control samples on the X axis.
#featAssayPlot1_Downsample;<p align="left">For this panel too, we apply downsampling.</p>
#collapse_featAssayPlot1_SelectBoxOpen;<p align="left">To restrict the plot to breast cancer tumor samples selected in the <font color="#402ee8">Column data plot</font> panel, we choose it as the source of point selection, and we apply the selection with a restriction effect.
#featAssayPlot1;<p align="left">This displays only the selected breast cancer tumor and control samples, effectively removing others from this plot.</p><p align="left">The resulting effect emphasises a subset of <i>HER2</i>-positive breast cancer tumor samples.
#heatMapPlot1;<p align="left"><font color="#402ee8">Heat map</font> panels offer a convenient way to jointly visualise sample- and feature-level information.</p><p align="left">Here, we visualise the top 60 <i>HER2</i> signature genes, selected by largest absolute coefficients reported in Supplementary Table S4 of Rahman <i>et al.</i>, and identified from <i><a href="http://bioconductor.org/packages/Rsubread/" target="_blank">Rsubread</a></i> FPKM values.</p>
#heatMapPlot1_FeatNameBoxOpen;<p align="left">To obtain this heat map, features were typed in using this selectize widget (that supports autocompletion).</p>
#heatMapPlot1_Import;<p align="left">Alternatively, sets of features may also be imported from other active panels.</p>
#rowStatTable1;<p align="left">For example, <font color="#402ee8">Row statistics table</font> panels are sources of features that may be imported into heat maps.</p>
#collapse_heatMapPlot1_SelectBoxOpen;<p align="left">Separately, we use here a second <font color="#402ee8">Column data plot</font> to restrict the samples visible in this heat map.</p>
#colDataPlot2;<p align="left">Namely, we selected the set of breast cancer samples that had been confirmed via immunohistochemistry to be <i>HER2</i> positive (n = 149) or negative (n = 513), used by Rahman <i>et al.</i> to estimate <i>HER2</i> pathway activity.</p>
#collapse_colDataPlot2_SelectBoxOpen;<p align="left">Note how this plot was subsetted itself using the first <font color="#402ee8">Column data plot</font> to ensure that only breast cancer samples are displayed and included in selections downstream of this panel.</p>
#colDataPlot2_PanelGeneralInfo;<p align="left">Yet, sharp eyes may notice that the total number of data points displayed in this panel (n=994) is less than the number of data points selected in the source <font color="#402ee8">Column data plot</font> (n=1195).</p><p align="left"> The discrepancy is due to the fact that data points with <code>NA</code> values are not displayed. In this case, this affects all of the control samples (n=113), and 88 of the tumor samples..</p>
#heatMapPlot1_CenterScale;<p align="left">Each row (i.e. feature) in the heat map is centered and scaled, to facilitate the visualisation of differences between samples.</p>
#heatMapPlot1_Lower;<p align="left">Outliers can often distort scales and hide much of the variation between samples. To alleviate this effect, we cap the lower...</p>
#heatMapPlot1_Upper;<p align="left">... and upper bounds of the color scale, effectively applying the same extreme color to values beyond 2 standard deviations from the row mean.</p>
#collapse_heatMapPlot1_ColDataBoxOpen;<p align="left">The legend for <i>HER2</i> status confirmed by immunohistochemistry (and any additional column data selected for the heat map) is displayed here.</p>
#heatMapPlot1;<p align="left">As a result, the expression of features in <i>HER2</i> positive samples (pink, on the right) may be compared to <i>HER2</i> negative samples (blue, on the left). Note how the gene expression of <i>HER2</i> itself (ERBB2, top row) corroborates the immunohistochemistry information.</p>
#heatMapPlot1_Clustered;<p align="left">The features are initially ordered by decreasing absolute coefficient, reported in Supplementary Table S4 of Rahman <i>et al.</i>. Visualisation and interpretation can often be facilitated by clustering features on their assay data.</p><p align="left"><strong>Action:</strong> Please click on this 'Cluster Features' button.</p>
#heatMapPlot1;<p align="left">See how the rows of the heat map were clustered, to group features with similar assay data profiles across samples. Unfortunately, even so, the expression profile of individual genes represented in this heat map do not reflect well their combined overall predictive power!</p>
#GoodBye;<p align="left">Thank you for taking the TCGA tour!</p>
